<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vårddatahubb Pilot — Gantt-schema</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        #root { height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
const { useState, useRef, useCallback, useMemo, useEffect } = React;

const INIT_TASKS = [
{id:"WP0-001",wp:"WP0",area:"Projektstyrning och samverkan",act:"Roller och ansvar",desc:"Fastställ roller för hubbteam, regionteam, mottagare och styrning. Tydliggör ansvar för beslut, leverans, datakvalitet och säkerhet.",del:"RACI-matris och kontaktlista",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"RACI beslutad och kommunicerad till alla pilotregioner",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP0-002",wp:"WP0",area:"Projektstyrning och samverkan",act:"Samverkansrytm och mötesformer",desc:"Sätt upp arbetspass varje vecka, regionavstämningar, teknikforum och beslutsmöten. Definiera vad som ska vara klart mellan möten.",del:"Mötesplan med agendas och leveranspunkter",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Alla möten bokade för kommande 8 veckor och ägare utsedda",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP0-003",wp:"WP0",area:"Projektstyrning och samverkan",act:"Arbete mellan möten",desc:"Definiera hur ni arbetar mellan möten: uppgiftspool, avstämningsformat, korta beslutsförslag och hur blockerare lyfts.",del:"Arbetssättsdokument v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Alla i teamet kan följa arbetssättet utan muntlig förklaring",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP0-004",wp:"WP0",area:"Projektstyrning och samverkan",act:"Anteckningar, beslut och ändringar",desc:"Inför enhetliga mallar för mötesanteckningar, beslutslogg och ändringslogg. Koppla beslut till backlog och paketversioner.",del:"Mallpaket och loggar",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Varje beslut får ID, datum, beslutande och konsekvens",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP0-005",wp:"WP0",area:"Projektstyrning och samverkan",act:"Prioritera standardpaket för piloten",desc:"Besluta vilka standardpaket som ska vara kod och vilka som kan vara instruktioner i piloten. Gör även urval per region om behov skiljer.",del:"Prioriteringsbeslut paket v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP1 första nulägesbild",god:"Lista med paket, nivå, ägare och plan för pilot",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP0-006",wp:"WP0",area:"Projektstyrning och samverkan",act:"Behovsbild och nyttoberättelse",desc:"Formulera behovet av hubben utifrån pilotregionernas verklighet och friktion i dagens arbetssätt. Koppla till regionvärde vid varje leverans.",del:"Nyttoberättelse och budskap v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Kan presenteras på 5 minuter och stöds av pilotexempel",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP0-007",wp:"WP0",area:"Projektstyrning och samverkan",act:"Risk- och beroendekarta",desc:"Identifiera risker kopplat till regionernas kapacitet, dataåtkomst, tid, juridik och teknik. Följ upp varje vecka.",del:"Riskregister och mitigeringar",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Riskregister med ägare och åtgärd per risk",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP0-008",wp:"WP0",area:"Projektstyrning och samverkan",act:"Kommunikationsplan för piloterna",desc:"Planera hur ni kommunicerar mot regioner, mottagare och intressenter. Fokus på vad som krävs av regionerna och vad hubben levererar.",del:"Kommunikationsplan v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-001",wp:"WP1",area:"Onboarding och regioninventering",act:"Onboardingpaket till regioner",desc:"Samla allt regionerna behöver: översikt, roller, tekniska förutsättningar, checklistor, exempeldata, kontaktvägar och support.",del:"Onboardingdokument v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Kan skickas till ny region och användas utan muntlig genomgång",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-002",wp:"WP1",area:"Onboarding och regioninventering",act:"Inventeringsmall och upplägg för workshops",desc:"Förbered workshopupplägg och mallar så att alla tre regioner inventeras på samma sätt.",del:"Workshoppaket v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Tre workshopar kan köras med samma upplägg och ge jämförbara resultat",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-003",wp:"WP1",area:"Onboarding och regioninventering",act:"Kickoff och överenskommelse",desc:"Kickoff med Pilotregion 1: syfte, roller, arbetssätt, vad regionen bidrar med och vad hubben levererar.",del:"Kickoff-protokoll och överenskommelse",str:"Gemensamt",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Kontaktpersoner och första leveranser överenskomna",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-004",wp:"WP1",area:"Onboarding och regioninventering",act:"Nulägesworkshop: process, ansvar och system",desc:"Workshop med Pilotregion 1 för att beskriva dagens process för datauttag, rapportering, datakvalitet och väntetidsberäkningar.",del:"Nulägesbeskrivning per region",str:"Region",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Dokumenterat flöde, systemlista och ansvariga",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-005",wp:"WP1",area:"Onboarding och regioninventering",act:"Paketmottagning och lokalt körsätt",desc:"Fastställ med Pilotregion 1 hur hubbens paket ska tas emot och köras lokalt, till exempel container, script, notebook eller pipeline.",del:"Mottagarmodell per region",str:"Gemensamt",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Beslut om körsätt och uppgraderingsprincip per region",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-006",wp:"WP1",area:"Onboarding och regioninventering",act:"Förmåga för breda uttag och schemaläggning",desc:"Verifiera Pilotregion 1: hur breda uttag görs till landning i vårddatalagret, hur ofta, och hur historik och versioner hanteras.",del:"Checklist uttag och historik",str:"Region",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Checklist ifylld och hinder åtgärdsplanerade",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-007",wp:"WP1",area:"Onboarding och regioninventering",act:"Teknisk anslutning mot hubben",desc:"Kartlägg Pilotregion 1: hur regionen kan ansluta till hubbens transportväg i pilotläge och målbild.",del:"Anslutningsplan per region",str:"Gemensamt",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Plan med val av fil, API eller båda och vem som gör vad",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-008",wp:"WP1",area:"Onboarding och regioninventering",act:"Kickoff och överenskommelse",desc:"Kickoff med Pilotregion 2: syfte, roller, arbetssätt, vad regionen bidrar med och vad hubben levererar.",del:"Kickoff-protokoll och överenskommelse",str:"Gemensamt",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Kontaktpersoner och första leveranser överenskomna",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-009",wp:"WP1",area:"Onboarding och regioninventering",act:"Nulägesworkshop: process, ansvar och system",desc:"Workshop med Pilotregion 2 för att beskriva dagens process för datauttag, rapportering, datakvalitet och väntetidsberäkningar.",del:"Nulägesbeskrivning per region",str:"Region",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Dokumenterat flöde, systemlista och ansvariga",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-010",wp:"WP1",area:"Onboarding och regioninventering",act:"Paketmottagning och lokalt körsätt",desc:"Fastställ med Pilotregion 2 hur hubbens paket ska tas emot och köras lokalt, till exempel container, script, notebook eller pipeline.",del:"Mottagarmodell per region",str:"Gemensamt",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Beslut om körsätt och uppgraderingsprincip per region",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-011",wp:"WP1",area:"Onboarding och regioninventering",act:"Förmåga för breda uttag och schemaläggning",desc:"Verifiera Pilotregion 2: hur breda uttag görs till landning i vårddatalagret, hur ofta, och hur historik och versioner hanteras.",del:"Checklist uttag och historik",str:"Region",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Checklist ifylld och hinder åtgärdsplanerade",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-012",wp:"WP1",area:"Onboarding och regioninventering",act:"Teknisk anslutning mot hubben",desc:"Kartlägg Pilotregion 2: hur regionen kan ansluta till hubbens transportväg i pilotläge och målbild.",del:"Anslutningsplan per region",str:"Gemensamt",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Plan med val av fil, API eller båda och vem som gör vad",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-013",wp:"WP1",area:"Onboarding och regioninventering",act:"Kickoff och överenskommelse",desc:"Kickoff med Pilotregion 3: syfte, roller, arbetssätt, vad regionen bidrar med och vad hubben levererar.",del:"Kickoff-protokoll och överenskommelse",str:"Gemensamt",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Kontaktpersoner och första leveranser överenskomna",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-014",wp:"WP1",area:"Onboarding och regioninventering",act:"Nulägesworkshop: process, ansvar och system",desc:"Workshop med Pilotregion 3 för att beskriva dagens process för datauttag, rapportering, datakvalitet och väntetidsberäkningar.",del:"Nulägesbeskrivning per region",str:"Region",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Dokumenterat flöde, systemlista och ansvariga",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-015",wp:"WP1",area:"Onboarding och regioninventering",act:"Paketmottagning och lokalt körsätt",desc:"Fastställ med Pilotregion 3 hur hubbens paket ska tas emot och köras lokalt, till exempel container, script, notebook eller pipeline.",del:"Mottagarmodell per region",str:"Gemensamt",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Beslut om körsätt och uppgraderingsprincip per region",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-016",wp:"WP1",area:"Onboarding och regioninventering",act:"Förmåga för breda uttag och schemaläggning",desc:"Verifiera Pilotregion 3: hur breda uttag görs till landning i vårddatalagret, hur ofta, och hur historik och versioner hanteras.",del:"Checklist uttag och historik",str:"Region",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Checklist ifylld och hinder åtgärdsplanerade",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-017",wp:"WP1",area:"Onboarding och regioninventering",act:"Teknisk anslutning mot hubben",desc:"Kartlägg Pilotregion 3: hur regionen kan ansluta till hubbens transportväg i pilotläge och målbild.",del:"Anslutningsplan per region",str:"Gemensamt",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Plan med val av fil, API eller båda och vem som gör vad",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP1-018",wp:"WP1",area:"Onboarding och regioninventering",act:"Gemensam ordlista",desc:"Säkerställ att hubb och regioner använder samma termer för basunderlag, urval, dataprodukt, leverans, aggregat och mappning.",del:"Ordlista v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-001",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Kravtolkning väntetider",desc:"Gå igenom alla variabler, definitioner och obligatoriska fält. Enas om tolkningar och gränsfall.",del:"Tolkningstabell väntetider v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP1 nulägesworkshop",god:"Alla variabler har beslutad tolkning",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-002",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Mappningssession väntetider",desc:"Workshop med Pilotregion 1 för mappning från regionens struktur till gemensam modell och OpenEHR-representation.",del:"Mappningsunderlag per region",str:"Gemensamt",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP2 kravtolkning",god:"Minst 90 procent mappade med källa, regel och ansvarig",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-003",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Första lokala körningen väntetider",desc:"Pilotregion 1 kör första uttaget och producerar dataset enligt hubbens instruktion. Samtidigt skapas aggregat för benchmark.",del:"Första testleverans och aggregat",str:"Region",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP6 transformationspaket och WP7 DQ",god:"Leverans går igenom validering och kan beräknas på",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-004",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Mappningssession väntetider",desc:"Workshop med Pilotregion 2 för mappning från regionens struktur till gemensam modell och OpenEHR-representation.",del:"Mappningsunderlag per region",str:"Gemensamt",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP2 kravtolkning",god:"Minst 90 procent mappade med källa, regel och ansvarig",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-005",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Första lokala körningen väntetider",desc:"Pilotregion 2 kör första uttaget och producerar dataset enligt hubbens instruktion. Samtidigt skapas aggregat för benchmark.",del:"Första testleverans och aggregat",str:"Region",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP6 transformationspaket och WP7 DQ",god:"Leverans går igenom validering och kan beräknas på",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-006",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Mappningssession väntetider",desc:"Workshop med Pilotregion 3 för mappning från regionens struktur till gemensam modell och OpenEHR-representation.",del:"Mappningsunderlag per region",str:"Gemensamt",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP2 kravtolkning",god:"Minst 90 procent mappade med källa, regel och ansvarig",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-007",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Första lokala körningen väntetider",desc:"Pilotregion 3 kör första uttaget och producerar dataset enligt hubbens instruktion. Samtidigt skapas aggregat för benchmark.",del:"Första testleverans och aggregat",str:"Region",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP6 transformationspaket och WP7 DQ",god:"Leverans går igenom validering och kan beräknas på",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP2-008",wp:"WP2",area:"Pilotdataprodukt Väntetider",act:"Samlad jämförelse mellan regioner",desc:"Jämför mappningar, skillnader i datainsamling och föreslå harmonisering i paket och instruktioner.",del:"Gaplista och harmonisering v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP3-001",wp:"WP3",area:"Pilotdataprodukt PAR",act:"Avgränsa PAR-delmängd",desc:"Besluta vilken del av PAR som piloten omfattar baserat på nytta och genomförbarhet. Definiera variabler, urval och period.",del:"Scopebeslut PAR v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Scope med variabler, urval och period beslutad",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP3-002",wp:"WP3",area:"Pilotdataprodukt PAR",act:"Privata vårdgivare och rapporteringsansvar",desc:"Klargör hur privata vårdgivare ska hanteras i piloten och vad regionen praktiskt behöver göra trots att vårdgivaren har rapporteringsansvar.",del:"Tillämpningsbeslut privata v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3 scope",god:"Beslut dokumenterat och kommunicerat till pilotregioner",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP3-003",wp:"WP3",area:"Pilotdataprodukt PAR",act:"Kartlägg PAR-data i regionen",desc:"Kartlägg Pilotregion 1: källor, kodverk, datalager och åtkomstvägar för vald PAR-delmängd.",del:"PAR-kartläggning per region",str:"Region",reg:"Pilotregion 1",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3 scope",god:"Källor och kodverk listade, ansvariga utsedda",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP3-004",wp:"WP3",area:"Pilotdataprodukt PAR",act:"Kartlägg PAR-data i regionen",desc:"Kartlägg Pilotregion 2: källor, kodverk, datalager och åtkomstvägar för vald PAR-delmängd.",del:"PAR-kartläggning per region",str:"Region",reg:"Pilotregion 2",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3 scope",god:"Källor och kodverk listade, ansvariga utsedda",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP3-005",wp:"WP3",area:"Pilotdataprodukt PAR",act:"Kartlägg PAR-data i regionen",desc:"Kartlägg Pilotregion 3: källor, kodverk, datalager och åtkomstvägar för vald PAR-delmängd.",del:"PAR-kartläggning per region",str:"Region",reg:"Pilotregion 3",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3 scope",god:"Källor och kodverk listade, ansvariga utsedda",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP3-006",wp:"WP3",area:"Pilotdataprodukt PAR",act:"PAR exportdefinition",desc:"Tolka formatkrav för vald delmängd och bestäm exportlogik och metadata.",del:"PAR exportdefinition v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3 scope",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP4-001",wp:"WP4",area:"Gemensam datamodell och definitioner",act:"Gemensam modell miniminivå",desc:"Enas om vilka begrepp som måste finnas för väntetider och PAR och hur de representeras i OpenEHR.",del:"Gemensam modell v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"Modell dokumenterad och granskad",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP4-002",wp:"WP4",area:"Gemensam datamodell och definitioner",act:"Mappningskonventioner",desc:"Bestäm konventioner för kodverk, datum, null-hantering, identifierare och enheter.",del:"Mappningskonventioner v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP4-003",wp:"WP4",area:"Gemensam datamodell och definitioner",act:"Spårbarhet miniminivå",desc:"Definiera hur datapunkter kan spåras till källa och regel utan stor börda för regionerna.",del:"Lineagekrav v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP5-001",wp:"WP5",area:"Datakatalog och metadata",act:"Metadata-minimipaket",desc:"Definiera metadata som alltid följer med en dataprodukt: källa, period, version, ansvarig, tillåten användning.",del:"Metadata-spec v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP5-002",wp:"WP5",area:"Datakatalog och metadata",act:"Datakatalogstruktur",desc:"Skapa struktur för dataprodukter, variabler och paket så att regionerna kan dokumentera lika.",del:"Katalogstruktur v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP5-003",wp:"WP5",area:"Datakatalog och metadata",act:"Regionernas metadata-arbetssätt",desc:"Beskriv hur regionen kan föra metadata i befintliga verktyg. Definiera miniminivå i dokumentform.",del:"Instruktion metadata i region",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP6-001",wp:"WP6",area:"Mappning och transformation",act:"Mappningsmotor: regelformat och versionsstyrning",desc:"Definiera hur mappningsregler uttrycks, versionshanteras och körs lokalt i regionerna.",del:"Spec mappningsmotor v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP4",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP6-002",wp:"WP6",area:"Mappning och transformation",act:"Transformationspaket väntetider",desc:"Ta fram ett första körbart paket som skapar basunderlag och urval för väntetider i OpenEHR-format.",del:"Transformationspaket väntetider v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP4 modell",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP6-003",wp:"WP6",area:"Mappning och transformation",act:"Transformationspaket PAR",desc:"Ta fram körbart paket för vald PAR-delmängd i OpenEHR-format.",del:"Transformationspaket PAR v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3 exportdefinition",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP6-004",wp:"WP6",area:"Mappning och transformation",act:"Export från OpenEHR till mottagarformat",desc:"Implementera exportlogik från OpenEHR-baserat basunderlag till Socialstyrelsens flat file för väntetider och PAR.",del:"Exportpaket SoS v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP9 dataprodukter",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP6-005",wp:"WP6",area:"Mappning och transformation",act:"Stöd för lokala variationer",desc:"Beskriv hur regioner hanterar lokala kodverk eller saknade fält med gemensamma undantagsmönster.",del:"Mönsterkatalog variationer v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP7-001",wp:"WP7",area:"Datakvalitet och validering",act:"DQ-regelbok miniminivå",desc:"Definiera DQ-kontroller för obligatoriska fält, format, kodverk, rimlighet och summeringar.",del:"DQ-regelbok v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP7-002",wp:"WP7",area:"Datakvalitet och validering",act:"DQ-rapportformat",desc:"Standardisera hur DQ-resultat rapporteras tillbaka: mått, trend och blockerare.",del:"DQ-rapportformat v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP7-003",wp:"WP7",area:"Datakvalitet och validering",act:"Återkopplingsloop DQ",desc:"Sätt rutin för triage och åtgärd av DQ-avvikelser med tydligt ansvar mellan region och hubb.",del:"Process DQ-återkoppling v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP8-001",wp:"WP8",area:"Beräkningar väntetider",act:"Samla källor för väntetidsberäkning",desc:"Samla beräkningsregler och förankra med sakkunniga så att pilotens räknesätt kan motiveras och reproduceras.",del:"Beräkningsunderlag v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP8-002",wp:"WP8",area:"Beräkningar väntetider",act:"Beräkningsspec väntetider",desc:"Dokumentera räknesätt, gränsfall och vilken logik som används vid urval och aggregering.",del:"Beräkningsspec v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP8 underlag",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP8-003",wp:"WP8",area:"Beräkningar väntetider",act:"Körbar beräkningskomponent",desc:"Implementera beräkning som kan köras lokalt i regiondemo och i verifieringsmiljö.",del:"Beräkningskomponent v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP6 transformationspaket",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP8-004",wp:"WP8",area:"Beräkningar väntetider",act:"Verifikation samma resultat",desc:"Bygg testfall som visar samma resultat från OpenEHR, Socialstyrelseformat och forskarformat.",del:"Verifieringsrapport beräkning v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP15",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP9-001",wp:"WP9",area:"Dataprodukter och mottagarformat",act:"Dataproduktdefinition väntetider",desc:"Definiera dataprodukten: urval, period, exportfält, metadata, indexering och kvalitetsgränser.",del:"Dataprodukt väntetider v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP9-002",wp:"WP9",area:"Dataprodukter och mottagarformat",act:"Dataproduktdefinition PAR",desc:"Definiera dataprodukten för vald PAR-del: urval, period, exportfält, metadata, indexering och kvalitetsgränser.",del:"Dataprodukt PAR v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP9-003",wp:"WP9",area:"Dataprodukter och mottagarformat",act:"Manifest och kvittensprincip",desc:"Definiera hur leveranser märks, versionssätts och kvitteras samt hur fel återrapporteras.",del:"Manifest och kvittens v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP10-001",wp:"WP10",area:"Transport, kvittens och drift",act:"Transportkontrakt region till hubb",desc:"Beskriv hur region skickar leveranser och aggregat och hur hubben svarar med kvittens. Stöd för pilotläge och målbild.",del:"Transportkontrakt v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP10-002",wp:"WP10",area:"Transport, kvittens och drift",act:"Pilotläge fil och målbild API",desc:"Besluta om piloten ska använda fil, API eller båda och implementera motsvarande i demon.",del:"Pilotbeslut och implementation v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP1 anslutningsplan",god:"Minst en leverans fungerar end to end",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP10-003",wp:"WP10",area:"Transport, kvittens och drift",act:"Felhantering och återkörning",desc:"Definiera återkörning vid fel med idempotens, versionsprincip och korrigering.",del:"Återkörningsmönster v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP10-004",wp:"WP10",area:"Transport, kvittens och drift",act:"Loggning och driftchecklista",desc:"Definiera miniminivå för loggning, spårbarhet, incidenthantering och support under piloten.",del:"Driftchecklista v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP11-001",wp:"WP11",area:"Benchmark och återkoppling",act:"Benchmarkspec för aggregat",desc:"Definiera vilket aggregat regionen skickar vid varje leverans och hur det kan jämföras över regioner och tid.",del:"Benchmarkspec v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP11-002",wp:"WP11",area:"Benchmark och återkoppling",act:"Återkopplingsvy för regioner",desc:"Skapa enkel vy eller rapport som visar jämförelser och datakvalitetstrender.",del:"Återkopplingsvy v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP7 DQ-rapportformat",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP11-003",wp:"WP11",area:"Benchmark och återkoppling",act:"Återkopplingsprocess",desc:"Sätt upp rutin för hur återkoppling används i regionerna och hur förbättringsförslag omvandlas till paketförändringar.",del:"Process återkoppling v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP12-001",wp:"WP12",area:"Säkerhet och pseudonymisering",act:"Säkerhetsprinciper för piloten",desc:"Tydliggör vad som behandlas var, vad som får lämna regionen och hur minimal lagring i hubben säkerställs.",del:"Säkerhetsprinciper v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP12-002",wp:"WP12",area:"Säkerhet och pseudonymisering",act:"Pseudonymisering i praktiken",desc:"Beskriv metodval och körning i regionflödet samt hur man testar utan personrisk.",del:"Instruktion pseudonymisering v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP12-003",wp:"WP12",area:"Säkerhet och pseudonymisering",act:"Åtkomstkontroll och spårbarhet för externa",desc:"Definiera miniminivå för åtkomstkontroll, loggning och spårbarhet när externa mottagare ska kunna ta emot leveranser.",del:"Åtkomst- och spårbarhetskrav v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP13-001",wp:"WP13",area:"Förvaltning och release av paket",act:"Versionsstrategi för paket",desc:"Definiera hur paket numreras och hur regioner uppgraderar utan att tappa reproducerbarhet.",del:"Versionsstrategi v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP13-002",wp:"WP13",area:"Förvaltning och release av paket",act:"Releaseprocess och kommunikation",desc:"Definiera release notes, releasekalender och uppgraderingsfönster samt ansvar för support.",del:"Releaseprocess v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP13-003",wp:"WP13",area:"Förvaltning och release av paket",act:"Uppgraderingstest i minst en region",desc:"Genomför ett test där region uppgraderar paketversion och kör om flödet med samma basunderlag.",del:"Uppgradering genomförd",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP17 CI/CD och WP6 paket",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP14-001",wp:"WP14",area:"Demo och testmiljöer",act:"Demomål och scenarier",desc:"Definiera vilka scenarier demon ska visa: paketpublicering, basunderlag, urval, leverans, kvittens, aggregat och återkoppling.",del:"Demoscenarier v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP14-002",wp:"WP14",area:"Demo och testmiljöer",act:"Demoarkitektur v1",desc:"Sätt en enkel referensarkitektur för demo: regiondel och hubbdel, med tydliga gränssnitt och artefakter.",del:"Demoarkitektur v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP14-003",wp:"WP14",area:"Demo och testmiljöer",act:"Regiondemo basunderlag och DQ",desc:"Bygg regiondemo som visar landning, basunderlag, mappning, DQ och skapande av urval.",del:"Regiondemo v1",str:"Region",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP17 basplattform",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP14-004",wp:"WP14",area:"Demo och testmiljöer",act:"Hubbdemo transport och kvittens",desc:"Bygg hubbdemo som tar emot leverans, vidarebefordrar till mottagare eller simulerar mottagare, och returnerar kvittens.",del:"Hubbdemo transport v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP10 transportkontrakt",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP14-005",wp:"WP14",area:"Demo och testmiljöer",act:"Hubbdemo benchmark och återkoppling",desc:"Bygg hubbdemo som tar emot aggregat, lagrar över tid och visar återkoppling till regioner.",del:"Hubbdemo benchmark v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP11 benchmarkspec",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP14-006",wp:"WP14",area:"Demo och testmiljöer",act:"Gemensam demogenomgång",desc:"Planera och genomför gemensam demogenomgång med tre regioner, inklusive insamling av förbättringsförslag.",del:"Demo genomförd",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP15-001",wp:"WP15",area:"Testdata och verifiering",act:"Testdata väntetider",desc:"Skapa realistisk testdata för väntetider med gränsfall som behövs för beräkning och DQ.",del:"Testdata väntetider v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP15-002",wp:"WP15",area:"Testdata och verifiering",act:"Testdata PAR",desc:"Skapa testdata för vald PAR-delmängd med relevanta kodverk och gränsfall.",del:"Testdata PAR v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP3 scope",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP15-003",wp:"WP15",area:"Testdata och verifiering",act:"Verifieringsramverk",desc:"Bygg tester för format, DQ och beräkningsresultat så att varje region kan köra samma kontrollsvit lokalt.",del:"Verifieringsramverk v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP15-004",wp:"WP15",area:"Testdata och verifiering",act:"Verifieringsrapport för stakeholder",desc:"Ta fram kort rapport som visar att demon är korrekt och reproducerbar, inklusive vilka antaganden som gjorts.",del:"Verifieringsrapport v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP16-001",wp:"WP16",area:"Federering och SPE",act:"Avgränsa federerad del i piloten",desc:"Besluta miniminivå för federerade frågor och vilka mått som demonstreras.",del:"Scope federering v1",str:"Gemensamt",reg:"Gemensamt",pri:"P2",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP16-002",wp:"WP16",area:"Federering och SPE",act:"POC federerad fråga",desc:"Skapa enkel federerad fråga som körs i regionerna och returnerar aggregerade delresultat.",del:"Federerad POC v1",str:"Hubb",reg:"Gemensamt",pri:"P2",sta:"Ej startad",ans:"",med:"",dep:"WP11 benchmarkspec",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP17-001",wp:"WP17",area:"Teknisk basplattform för paket och demo",act:"Kodrepo och arbetsstruktur för paket",desc:"Sätt upp repo, mappstruktur, licens, kodstandard och grunddokumentation så att paket kan utvecklas och granskas.",del:"Repo och struktur v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP17-002",wp:"WP17",area:"Teknisk basplattform för paket och demo",act:"Paketering och publicering",desc:"Definiera hur standardpaket byggs, versionssätts och publiceras så att regioner kan hämta rätt version.",del:"Paketeringspipeline v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP13 versionsstrategi",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP17-003",wp:"WP17",area:"Teknisk basplattform för paket och demo",act:"CI/CD för demo och paket",desc:"Sätt upp pipeline för test, build och deploy av demo samt testkörningar av paket.",del:"CI/CD v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP17-004",wp:"WP17",area:"Teknisk basplattform för paket och demo",act:"Regiondemo teknisk miljö",desc:"Sätt upp teknisk demo för region: körmiljö för transformation, DQ och beräkning samt lagring av basunderlag.",del:"Regiondemo miljö v1",str:"Region",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP17 CI/CD",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP17-005",wp:"WP17",area:"Teknisk basplattform för paket och demo",act:"Hubbdemo teknisk miljö",desc:"Sätt upp teknisk demo för hubb: mottagning, vidarebefordran, kvittens, aggregatlagring och enkel återkoppling.",del:"Hubbdemo miljö v1",str:"Hubb",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"WP17 CI/CD",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
{id:"WP17-006",wp:"WP17",area:"Teknisk basplattform för paket och demo",act:"Observability och felsökning",desc:"Inför grundloggning, spårbarhets-id och enkel övervakning så att demon går att köra i möten utan handpåläggning.",del:"Loggning och spårbarhet v1",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""},
];

// Prioritet = kantfärg (2px linje)
const PC={P0:{c:"#2563eb",lb:"P0 Kritisk"},P1:{c:"#16a34a",lb:"P1 Hög"},P2:{c:"#eab308",lb:"P2 Normal"}};
// Status = ifyllnadsfärg
const SC={"Ej startad":"#bfdbfe","Pågår":"#3b82f6","Klar":"#22c55e","Blockerad":"#ef4444"};
const SD={Hubb:"#7c3aed",Region:"#ea580c",Gemensamt:"#64748b"};
const CW=32,RH=38,WH=44,LW_DEFAULT=350,LW_MIN=200,LW_MAX=600;
const T0=new Date(2026,1,2),TEND=new Date(2026,7,31),TDAYS=Math.ceil((TEND-T0)/864e5);
const d2x=d=>Math.round(((d instanceof Date?d:new Date(d))-T0)/864e5)*CW;
const fmt=d=>d.toLocaleDateString("sv-SE",{day:"numeric",month:"short"});
const iso=d=>{const t=new Date(d);t.setHours(0,0,0,0);t.setDate(t.getDate()+3-(t.getDay()+6)%7);const w=new Date(t.getFullYear(),0,4);return 1+Math.round(((t-w)/864e5-3+(w.getDay()+6)%7)/7);};
const addD=(d,n)=>{const r=new Date(d);r.setDate(r.getDate()+n);return r;};

// Veckoschema per WP (veckonummer 2026)
const WP_WEEKS = {
  WP0:[6,8], WP1:[6,8], WP2:[6,12], WP3:[6,12], WP4:[6,12],
  WP5:[15,20], WP6:[6,12], WP7:[8,14], WP8:[6,8], WP9:[8,12],
  WP10:[12,16], WP11:[16,20], WP12:[19,24], WP13:[24,28],
  WP14:[6,17], WP15:[6,11], WP16:[33,36], WP17:[6,16]
};
const week2date=(w)=>addD(T0,(w-6)*7);

function initSchedule(tasks){
  const s={};
  const grp=new Map();
  tasks.forEach(t=>{if(!grp.has(t.wp))grp.set(t.wp,[]);grp.get(t.wp).push(t);});
  [...grp.entries()].forEach(([wp,items])=>{
    const [ws,we]=WP_WEEKS[wp]||[6,12];
    const totalDays=(we-ws)*7;
    const taskDur=Math.max(5,Math.floor(totalDays/items.length));
    items.forEach((t,i)=>{
      const st=addD(week2date(ws),Math.floor(i*totalDays/items.length));
      s[t.id]={start:st,end:addD(st,taskDur)};
    });
  });
  return s;
}

const FIELDS=[{k:"act",l:"Aktivitet",t:"text"},{k:"desc",l:"Beskrivning",t:"area"},{k:"del",l:"Leverabel",t:"text"},{k:"pri",l:"Prioritet",t:"select",o:["P0","P1","P2"]},{k:"sta",l:"Status",t:"select",o:["Ej startad","Pågår","Klar","Blockerad"]},{k:"str",l:"Ström",t:"select",o:["Hubb","Region","Gemensamt"]},{k:"reg",l:"Region",t:"select",o:["Gemensamt","Pilotregion 1","Pilotregion 2","Pilotregion 3"]},{k:"ins",l:"Insats",t:"select",o:["S","M","L","XL"]},{k:"ans",l:"Ansvarig",t:"text"},{k:"med",l:"Medverkande",t:"text"},{k:"dep",l:"Beroenden",t:"text"},{k:"god",l:"Godkännandekriterier",t:"area"},{k:"lnk",l:"Länkar/Artefakter",t:"text"},{k:"rol",l:"Ansvarig roll",t:"text"},{k:"gdk",l:"Godkännare",t:"text"},{k:"bes",l:"Beslutsforum",t:"text"},{k:"cmt",l:"Kommentarer",t:"bigarea"}];

function Gantt(){
const[tasks,setTasks]=useState(INIT_TASKS);
const[sched,setSched]=useState(()=>initSchedule(INIT_TASKS));
const[exp,setExp]=useState(new Set(["WP0","WP1"]));
const[sel,setSel]=useState(null);
const[fP,setFP]=useState(new Set(["P0","P1","P2"]));
const[fS,setFS]=useState("Alla");
const[drag,setDrag]=useState(null);
const[arrows,setArrows]=useState([]);
const[arrowMode,setArrowMode]=useState(false);
const[arrowFrom,setArrowFrom]=useState(null);
const[undoS,setUndoS]=useState([]);
const[leftW,setLeftW]=useState(LW_DEFAULT);
const[resizing,setResizing]=useState(false);
const tRef=useRef(null),lRef=useRef(null);

const groups=useMemo(()=>{const m=new Map();tasks.forEach(t=>{if(!m.has(t.wp))m.set(t.wp,{wp:t.wp,area:t.area,tasks:[]});m.get(t.wp).tasks.push(t);});return[...m.values()];},[tasks]);
const filtered=useMemo(()=>groups.map(g=>({...g,tasks:g.tasks.filter(t=>fP.has(t.pri)&&(fS==="Alla"||t.str===fS))})).filter(g=>g.tasks.length>0),[groups,fP,fS]);
const rows=useMemo(()=>{const r=[];filtered.forEach(g=>{r.push({type:"wp",data:g});if(exp.has(g.wp))g.tasks.forEach(t=>r.push({type:"task",data:t}));});return r;},[filtered,exp]);
const tog=wp=>setExp(p=>{const n=new Set(p);n.has(wp)?n.delete(wp):n.add(wp);return n;});
const togP=p=>setFP(pr=>{const n=new Set(pr);n.has(p)?n.delete(p):n.add(p);return n;});
const push=()=>setUndoS(p=>[...p.slice(-20),{s:JSON.parse(JSON.stringify(sched)),t:JSON.parse(JSON.stringify(tasks)),a:[...arrows]}]);
const doUndo=()=>{if(!undoS.length)return;const u=undoS[undoS.length-1];setUndoS(p=>p.slice(0,-1));const rs={};Object.entries(u.s).forEach(([k,v])=>{rs[k]={start:new Date(v.start),end:new Date(v.end)};});setSched(rs);setTasks(u.t);setArrows(u.a);};
const updTask=(id,f,v)=>{push();setTasks(p=>p.map(t=>t.id===id?{...t,[f]:v}:t));if(sel?.id===id)setSel(p=>({...p,[f]:v}));};
const updDate=(id,f,v)=>{push();setSched(p=>{const c={...p},e={...c[id]};e[f]=new Date(v);if(e.start>=e.end)return p;c[id]=e;return c;});};
const delTask=id=>{push();setTasks(p=>p.filter(t=>t.id!==id));setSched(p=>{const c={...p};delete c[id];return c;});setArrows(p=>p.filter(a=>a.from!==id&&a.to!==id));if(sel?.id===id)setSel(null);};
const addTask=wp=>{push();const g=tasks.filter(t=>t.wp===wp);const num=g.length+1;const nid=`${wp}-${String(num).padStart(3,"0")}`;const area=g.length?g[0].area:wp;const nt={id:nid,wp,area,act:"Ny aktivitet",desc:"",del:"",str:"Gemensamt",reg:"Gemensamt",pri:"P1",sta:"Ej startad",ans:"",med:"",dep:"",god:"",ins:"M",lnk:"",rol:"",gdk:"",bes:"",cmt:""};setTasks(p=>[...p,nt]);const ls=g.length&&sched[g[g.length-1].id]?sched[g[g.length-1].id]:null;const st=ls?addD(ls.end,1):new Date(T0);setSched(p=>({...p,[nid]:{start:st,end:addD(st,9)}}));setExp(p=>new Set([...p,wp]));setSel(nt);};

const onPD=useCallback((e,id,mode)=>{e.preventDefault();e.stopPropagation();push();const s=sched[id];setDrag({id,mode,os:new Date(s.start),oe:new Date(s.end),sx:e.clientX});e.target.setPointerCapture(e.pointerId);},[sched]);
const onPM=useCallback(e=>{if(!drag)return;const dd=Math.round((e.clientX-drag.sx)/CW);setSched(p=>{const c={...p},en={...c[drag.id]};if(drag.mode==="move"){en.start=addD(drag.os,dd);en.end=addD(drag.oe,dd);}else if(drag.mode==="right"){const ne=addD(drag.oe,dd);if(ne>en.start)en.end=ne;}else{const ns=addD(drag.os,dd);if(ns<en.end)en.start=ns;}c[drag.id]=en;return c;});},[drag]);
const onPU=useCallback(()=>setDrag(null),[]);
useEffect(()=>{if(drag){const m=e=>onPM(e),u=()=>onPU();window.addEventListener("pointermove",m);window.addEventListener("pointerup",u);return()=>{window.removeEventListener("pointermove",m);window.removeEventListener("pointerup",u);};}},[drag,onPM,onPU]);

const handleBar=t=>{if(arrowMode){if(!arrowFrom)setArrowFrom(t.id);else if(arrowFrom!==t.id){push();setArrows(p=>[...p,{from:arrowFrom,to:t.id}]);setArrowFrom(null);}else setArrowFrom(null);}else setSel(t);};

// Resize kolumn
const onResizeStart=useCallback(e=>{e.preventDefault();setResizing(true);},[]);
const onResizeMove=useCallback(e=>{if(!resizing)return;const newW=Math.min(LW_MAX,Math.max(LW_MIN,e.clientX));setLeftW(newW);},[resizing]);
const onResizeEnd=useCallback(()=>setResizing(false),[]);
useEffect(()=>{if(resizing){window.addEventListener("mousemove",onResizeMove);window.addEventListener("mouseup",onResizeEnd);return()=>{window.removeEventListener("mousemove",onResizeMove);window.removeEventListener("mouseup",onResizeEnd);};}},[resizing,onResizeMove,onResizeEnd]);

const weeks=useMemo(()=>{const w=[];for(let i=0;i<TDAYS;i+=7)w.push(addD(T0,i));return w;},[]);
const months=useMemo(()=>{const m=[];let c=null;weeks.forEach((w,i)=>{const l=w.toLocaleDateString("sv-SE",{month:"short",year:"numeric"});if(l!==c){m.push({l,s:i,n:1});c=l;}else m[m.length-1].n++;});return m;},[weeks]);
const totW=weeks.length*CW*7,totH=rows.reduce((s,r)=>s+(r.type==="wp"?WH:RH),0);
const todayX=d2x(new Date());
const wpRange=wp=>{let mi=Infinity,mx=-Infinity;tasks.filter(t=>t.wp===wp).forEach(t=>{const s=sched[t.id];if(!s)return;if(s.start.getTime()<mi)mi=s.start.getTime();if(s.end.getTime()>mx)mx=s.end.getTime();});return mi===Infinity?null:{start:new Date(mi),end:new Date(mx)};};
const rowYMap=useMemo(()=>{const m={};let y=0;rows.forEach(r=>{const h=r.type==="wp"?WH:RH;if(r.type==="task")m[r.data.id]=y+h/2;y+=h;});return m;},[rows]);

const syncS=(s,t)=>e=>{if(t.current)t.current.scrollTop=e.target.scrollTop;};
const I=({v,onChange,t="text",o})=>{const b={fontSize:12,padding:"5px 8px",border:"1px solid #c9bfa3",borderRadius:4,background:"#fff",width:"100%",boxSizing:"border-box",fontFamily:"inherit"};if(t==="select")return<select value={v}onChange={e=>onChange(e.target.value)}style={b}>{o.map(x=><option key={x}value={x}>{x}</option>)}</select>;if(t==="area")return<textarea value={v}onChange={e=>onChange(e.target.value)}rows={2}style={{...b,resize:"vertical"}}/>;if(t==="bigarea")return<textarea value={v}onChange={e=>onChange(e.target.value)}rows={5}style={{...b,resize:"vertical",minHeight:120}}/>;return<input type="text"value={v}onChange={e=>onChange(e.target.value)}style={b}/>;};

return(<div style={{fontFamily:"'DM Sans','Segoe UI',system-ui,sans-serif",background:"#faf8f3",color:"#1e1b16",height:"100vh",display:"flex",flexDirection:"column",userSelect:drag?"none":"auto"}}>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet"/>
<div style={{padding:"12px 18px 10px",borderBottom:"2px solid #c9bfa3",background:"linear-gradient(180deg,#f0ebe0,#faf8f3)",flexShrink:0}}>
<div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8}}>
<div><h1 style={{margin:0,fontSize:18,fontWeight:700,letterSpacing:"-0.02em"}}>Vårddatahubb Pilot — Gantt-schema</h1><p style={{margin:"2px 0 0",fontSize:11,color:"#8a7e66"}}>{tasks.length} aktiviteter · {groups.length} arbetspaket · v6 (2 feb) → 31 aug 2026</p></div>
<div style={{display:"flex",gap:4,flexWrap:"wrap"}}>
<button onClick={doUndo}disabled={!undoS.length}style={{padding:"4px 10px",fontSize:11,fontWeight:600,background:undoS.length?"#fff":"#eee",border:"1px solid #c9bfa3",borderRadius:4,cursor:undoS.length?"pointer":"default",color:undoS.length?"#5c5040":"#bbb"}}>↩ Ångra</button>
<button onClick={()=>setExp(new Set(groups.map(g=>g.wp)))}style={{padding:"4px 10px",fontSize:11,fontWeight:600,background:"#fff",border:"1px solid #c9bfa3",borderRadius:4,cursor:"pointer",color:"#5c5040"}}>Visa alla</button>
<button onClick={()=>setExp(new Set())}style={{padding:"4px 10px",fontSize:11,fontWeight:600,background:"#fff",border:"1px solid #c9bfa3",borderRadius:4,cursor:"pointer",color:"#5c5040"}}>Dölj alla</button>
<button onClick={()=>{setArrowMode(m=>!m);setArrowFrom(null);}}style={{padding:"4px 10px",fontSize:11,fontWeight:600,background:arrowMode?"#dc2626":"#fff",border:`1px solid ${arrowMode?"#dc2626":"#c9bfa3"}`,borderRadius:4,cursor:"pointer",color:arrowMode?"#fff":"#5c5040"}}>{arrowMode?(arrowFrom?"Klicka mål...":"Rita beroende (aktiv)"):"Rita beroende"}</button>
</div>
</div>
<div style={{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"}}>
<span style={{fontSize:10,fontWeight:700,color:"#8a7e66",textTransform:"uppercase",letterSpacing:".08em"}}>Prioritet:</span>
{Object.entries(PC).map(([k,v])=><button key={k}onClick={()=>togP(k)}style={{padding:"3px 10px",fontSize:11,fontWeight:600,borderRadius:16,border:`1.5px solid ${v.c}`,background:fP.has(k)?v.c:"transparent",color:fP.has(k)?"#fff":v.c,cursor:"pointer"}}>{v.lb}</button>)}
<span style={{fontSize:10,fontWeight:700,color:"#8a7e66",textTransform:"uppercase",letterSpacing:".08em",marginLeft:4}}>Ström:</span>
{["Alla","Hubb","Region","Gemensamt"].map(s=><button key={s}onClick={()=>setFS(s)}style={{padding:"3px 10px",fontSize:11,fontWeight:600,borderRadius:16,border:`1.5px solid ${s==="Alla"?"#8a7e66":SD[s]}`,background:fS===s?(s==="Alla"?"#8a7e66":SD[s]):"transparent",color:fS===s?"#fff":(s==="Alla"?"#8a7e66":SD[s]),cursor:"pointer"}}>{s}</button>)}
</div>
</div>
<div style={{display:"flex",flex:1,overflow:"hidden",cursor:resizing?"col-resize":"auto"}}>
<div style={{width:leftW,flexShrink:0,borderRight:"none",display:"flex",flexDirection:"column",position:"relative"}}>
<div style={{height:46,borderBottom:"1px solid #c9bfa3",display:"flex",alignItems:"center",padding:"0 12px",background:"#ede7d8",flexShrink:0}}><span style={{fontSize:10,fontWeight:700,color:"#8a7e66",textTransform:"uppercase",letterSpacing:".08em"}}>Arbetspaket / Aktivitet</span></div>
<div ref={lRef}onScroll={syncS(lRef,tRef)}style={{flex:1,overflowY:"auto",overflowX:"hidden"}}><div style={{minHeight:totH}}>
{rows.map(r=>r.type==="wp"?(<div key={r.data.wp}style={{height:WH,display:"flex",alignItems:"center",padding:"0 8px",background:exp.has(r.data.wp)?"#e8e1d0":"#f0ebe0",borderBottom:"1px solid #d5cdba"}}><span onClick={()=>tog(r.data.wp)}style={{cursor:"pointer",display:"flex",alignItems:"center",flex:1,overflow:"hidden"}}><span style={{fontSize:12,marginRight:6,color:"#8a7e66",transform:exp.has(r.data.wp)?"rotate(90deg)":"none",transition:"transform .15s",display:"inline-block"}}>▶</span><span style={{fontFamily:"'DM Mono',monospace",fontSize:11,fontWeight:600,color:"#5c5040",marginRight:6,minWidth:36}}>{r.data.wp}</span><span style={{fontSize:12,fontWeight:600,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{r.data.area}</span><span style={{fontSize:10,color:"#8a7e66",marginLeft:4}}>{r.data.tasks.length}</span></span><button onClick={()=>addTask(r.data.wp)}title="Lägg till"style={{marginLeft:4,background:"none",border:"1px solid #c9bfa3",borderRadius:4,cursor:"pointer",fontSize:14,color:"#0d7347",width:22,height:22,display:"flex",alignItems:"center",justifyContent:"center",padding:0}}>+</button></div>):(<div key={r.data.id}onClick={()=>handleBar(r.data)}style={{height:RH,display:"flex",alignItems:"center",padding:"0 8px 0 30px",cursor:"pointer",background:sel?.id===r.data.id?"#e0d8c4":arrowFrom===r.data.id?"#fef3c7":"transparent",borderBottom:"1px solid #ece5d5"}}onMouseEnter={e=>{if(sel?.id!==r.data.id&&arrowFrom!==r.data.id)e.currentTarget.style.background="#f0ebe0";}}onMouseLeave={e=>{if(sel?.id!==r.data.id&&arrowFrom!==r.data.id)e.currentTarget.style.background="transparent";}}><span style={{width:6,height:6,borderRadius:"50%",marginRight:6,flexShrink:0,border:`2px solid ${PC[r.data.pri]?.c||"#999"}`,background:SC[r.data.sta]||"#bfdbfe"}}/><span style={{fontFamily:"'DM Mono',monospace",fontSize:10,color:"#8a7e66",marginRight:6,minWidth:56}}>{r.data.id}</span><span style={{fontSize:11.5,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{r.data.act}</span></div>))}
</div></div>
</div>
<div onMouseDown={onResizeStart} style={{width:6,cursor:"col-resize",background:"linear-gradient(90deg,#c9bfa3,#d5cdba,#c9bfa3)",flexShrink:0,position:"relative"}}><div style={{position:"absolute",top:"50%",left:1,width:4,height:30,marginTop:-15,background:"#a89f8a",borderRadius:2,opacity:0.6}}/></div>
<div ref={tRef}onScroll={syncS(tRef,lRef)}style={{flex:1,overflow:"auto"}}>
<div style={{position:"sticky",top:0,zIndex:10,background:"#ede7d8"}}>
<div style={{display:"flex",height:22,borderBottom:"1px solid #d5cdba"}}>{months.map((m,i)=><div key={i}style={{width:m.n*CW*7,flexShrink:0,fontSize:10,fontWeight:700,color:"#5c5040",textTransform:"capitalize",display:"flex",alignItems:"center",justifyContent:"center",borderRight:"1px solid #d5cdba"}}>{m.l}</div>)}</div>
<div style={{display:"flex",height:24,borderBottom:"2px solid #c9bfa3"}}>{weeks.map((w,i)=><div key={i}style={{width:CW*7,flexShrink:0,fontSize:9,color:"#8a7e66",display:"flex",alignItems:"center",justifyContent:"center",borderRight:"1px solid #e8e1d0"}}>v{iso(w)}</div>)}</div>
</div>
<div style={{position:"relative",minHeight:totH,minWidth:totW}}>
{weeks.map((_,i)=><div key={i}style={{position:"absolute",left:i*CW*7,top:0,bottom:0,width:1,background:i%4===0?"#d5cdba":"#ece5d5"}}/>)}
{todayX>0&&todayX<totW&&<div style={{position:"absolute",left:todayX,top:0,bottom:0,width:2,background:"#dc2626",zIndex:6}}><div style={{position:"absolute",top:-2,left:-18,background:"#dc2626",color:"#fff",fontSize:9,fontWeight:700,padding:"2px 5px",borderRadius:3}}>IDAG</div></div>}
<svg style={{position:"absolute",top:0,left:0,width:totW,height:totH,pointerEvents:"none",zIndex:5}}>
{arrows.map((a,i)=>{const sf=sched[a.from],st=sched[a.to];if(!sf||!st)return null;const yf=rowYMap[a.from],yt=rowYMap[a.to];if(yf===undefined||yt===undefined)return null;const x1=d2x(sf.end),x2=d2x(st.start),mx=(x1+x2)/2;return<g key={i}style={{pointerEvents:"auto",cursor:"pointer"}}onClick={()=>{push();setArrows(p=>p.filter((_,j)=>j!==i));}}><path d={`M${x1},${yf} C${mx},${yf} ${mx},${yt} ${x2},${yt}`}fill="none"stroke="#dc2626"strokeWidth={2}strokeDasharray="6,3"/><polygon points={`${x2},${yt} ${x2-8},${yt-4} ${x2-8},${yt+4}`}fill="#dc2626"/><path d={`M${x1},${yf} C${mx},${yf} ${mx},${yt} ${x2},${yt}`}fill="none"stroke="transparent"strokeWidth={12}/></g>;})}
</svg>
{(()=>{let y=0;return rows.map(r=>{const isW=r.type==="wp";const h=isW?WH:RH;const cy=y;y+=h;if(isW){const rng=wpRange(r.data.wp);if(!rng)return<div key={`w-${r.data.wp}`}style={{position:"absolute",top:cy,height:h,left:0,right:0,background:"rgba(212,201,168,.12)",borderBottom:"1px solid #d5cdba"}}/>;const x=d2x(rng.start),w=Math.max(d2x(rng.end)-x,20);return<div key={`w-${r.data.wp}`}style={{position:"absolute",top:cy,height:h,left:0,right:0,background:exp.has(r.data.wp)?"rgba(212,201,168,.12)":"rgba(232,225,208,.25)",borderBottom:"1px solid #d5cdba"}}><div style={{position:"absolute",top:(h-12)/2,height:12,left:x,width:w,background:"linear-gradient(90deg,#b5a882,#c9bfa3)",borderRadius:3,opacity:.4}}/></div>;}
const t=r.data,sch=sched[t.id];if(!sch)return null;const x=d2x(sch.start),w=Math.max(d2x(sch.end)-x,14);const borderC=PC[t.pri]?.c||"#999";const fillC=SC[t.sta]||"#bfdbfe";const isSel=sel?.id===t.id;const bH=20,bY=(h-bH)/2;const isAF=arrowFrom===t.id;const textC=t.sta==="Ej startad"?"#1e3a5f":"#fff";
return<div key={`b-${t.id}`}style={{position:"absolute",top:cy,height:h,left:0,right:0,borderBottom:"1px solid #ece5d5"}}>
<div onPointerDown={e=>!arrowMode&&onPD(e,t.id,"move")}onClick={()=>handleBar(t)}style={{position:"absolute",top:bY,height:bH,left:x+6,width:Math.max(w-12,8),background:isAF?`repeating-linear-gradient(45deg,${fillC},${fillC} 4px,${fillC}99 4px,${fillC}99 8px)`:fillC,border:`2px solid ${borderC}`,borderRadius:4,cursor:arrowMode?"crosshair":drag?.id===t.id?"grabbing":"grab",display:"flex",alignItems:"center",paddingLeft:4,zIndex:2,boxShadow:isSel?`0 0 0 2px ${borderC},0 2px 8px ${borderC}44`:"0 1px 3px rgba(0,0,0,.15)"}}>{w>70&&<span style={{fontSize:9.5,color:textC,fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",pointerEvents:"none"}}>{t.id}</span>}</div>
{!arrowMode&&<div onPointerDown={e=>onPD(e,t.id,"left")}style={{position:"absolute",top:bY,height:bH,left:x,width:8,cursor:"ew-resize",zIndex:3}}/>}
{!arrowMode&&<div onPointerDown={e=>onPD(e,t.id,"right")}style={{position:"absolute",top:bY,height:bH,left:x+w-8,width:8,cursor:"ew-resize",zIndex:3}}/>}
</div>;});})()}
</div>
</div>
</div>
{sel&&!arrowMode&&<><div onClick={()=>setSel(null)}style={{position:"fixed",inset:0,background:"rgba(0,0,0,.1)",zIndex:80}}/>
<div style={{position:"fixed",top:0,right:0,bottom:0,width:420,background:"#fcfaf6",borderLeft:"2px solid #c9bfa3",boxShadow:"-6px 0 24px rgba(0,0,0,.1)",zIndex:90,display:"flex",flexDirection:"column",fontFamily:"'DM Sans',sans-serif",overflow:"hidden"}}>
<div style={{padding:"14px 16px 10px",borderBottom:"1px solid #e0d8c4",flexShrink:0}}>
<div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}>
<span style={{fontSize:11,fontWeight:700,color:"#1e3a5f",background:SC[sel.sta]||"#bfdbfe",border:`2px solid ${PC[sel.pri]?.c||"#999"}`,padding:"2px 10px",borderRadius:4}}>{sel.id} · {sel.wp}</span>
<div style={{display:"flex",gap:4}}><button onClick={()=>{if(confirm(`Radera ${sel.id}?`))delTask(sel.id);}}style={{background:"#fef2f2",border:"1px solid #fca5a5",borderRadius:4,cursor:"pointer",fontSize:11,color:"#dc2626",padding:"3px 8px",fontWeight:600}}>Radera</button><button onClick={()=>setSel(null)}style={{background:"none",border:"none",fontSize:20,cursor:"pointer",color:"#8a7e66"}}>×</button></div>
</div>
</div>
<div style={{padding:"10px 16px",overflowY:"auto",flex:1}}>
<div style={{background:"#f0ebe0",borderRadius:6,padding:10,marginBottom:10}}>
<div style={{fontSize:10,fontWeight:700,color:"#8a7e66",textTransform:"uppercase",letterSpacing:".06em",marginBottom:6}}>Datum</div>
<div style={{display:"grid",gridTemplateColumns:"50px 1fr",gap:"6px 8px",alignItems:"center"}}>
<label style={{fontSize:11,fontWeight:600,color:"#5c5040"}}>Start:</label>
<input type="date"value={sched[sel.id]?.start.toISOString().slice(0,10)||""}onChange={e=>updDate(sel.id,"start",e.target.value)}style={{padding:"4px 6px",fontSize:12,border:"1px solid #c9bfa3",borderRadius:4,background:"#fff",fontFamily:"'DM Mono',monospace"}}/>
<label style={{fontSize:11,fontWeight:600,color:"#5c5040"}}>Slut:</label>
<input type="date"value={sched[sel.id]?.end.toISOString().slice(0,10)||""}onChange={e=>updDate(sel.id,"end",e.target.value)}style={{padding:"4px 6px",fontSize:12,border:"1px solid #c9bfa3",borderRadius:4,background:"#fff",fontFamily:"'DM Mono',monospace"}}/>
</div>
<div style={{fontSize:10,color:"#8a7e66",marginTop:4}}>{(()=>{const s=sched[sel.id];if(!s)return"";return `${fmt(s.start)} → ${fmt(s.end)} (${Math.round((s.end-s.start)/864e5)} dagar)`;})()}</div>
</div>
{FIELDS.map(f=><div key={f.k}style={{marginBottom:7}}><label style={{fontSize:10,fontWeight:700,color:"#8a7e66",textTransform:"uppercase",letterSpacing:".05em",display:"block",marginBottom:2}}>{f.l}</label><I v={sel[f.k]||""}onChange={v=>updTask(sel.id,f.k,v)}t={f.t}o={f.o}/></div>)}
{arrows.filter(a=>a.from===sel.id||a.to===sel.id).length>0&&<div style={{marginTop:8,padding:8,background:"#fef9ee",borderRadius:6,border:"1px dashed #d4c088"}}><div style={{fontSize:10,fontWeight:700,color:"#a08430",marginBottom:4}}>Ritade beroenden</div>{arrows.filter(a=>a.from===sel.id||a.to===sel.id).map((a,i)=><div key={i}style={{fontSize:11,color:"#6b5c32"}}>{a.from} → {a.to}</div>)}</div>}
</div>
</div></>}
<div style={{padding:"6px 18px",borderTop:"1px solid #c9bfa3",background:"#f0ebe0",display:"flex",gap:10,alignItems:"center",fontSize:10,color:"#8a7e66",flexShrink:0,flexWrap:"wrap"}}>
<span style={{fontWeight:600}}>Kant:</span>
{Object.entries(PC).map(([k,v])=><span key={k}style={{display:"flex",alignItems:"center",gap:3}}><span style={{width:12,height:6,borderRadius:2,border:`2px solid ${v.c}`,background:"#fff"}}/>{v.lb}</span>)}
<span style={{fontWeight:600,marginLeft:8}}>Fyllning:</span>
{Object.entries(SC).map(([k,v])=><span key={k}style={{display:"flex",alignItems:"center",gap:3}}><span style={{width:12,height:6,borderRadius:2,background:v}}/>{k}</span>)}
<span><span style={{display:"inline-block",width:8,height:2,background:"#dc2626",verticalAlign:"middle",marginRight:3}}/>Idag</span>
<span style={{marginLeft:"auto",fontStyle:"italic"}}>Dra kolumnkant · Dra staplar · Klicka → redigera</span>
</div>
</div>);
}

ReactDOM.createRoot(document.getElementById('root')).render(<Gantt />);
    </script>
</body>
</html>
